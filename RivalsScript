local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")

-- Ensure the script runs on the client
local player = Players.LocalPlayer
if not player then
    repeat
        task.wait()
        player = Players.LocalPlayer
    until player
end

-- UI Elements
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextBox = Instance.new("TextBox")
local CheckKey = Instance.new("TextButton")
local CopyKey = Instance.new("TextButton")
local Notification = Instance.new("TextLabel") -- Notification label

-- Parent setup
ScreenGui.Parent = player:WaitForChild("PlayerGui")
Frame.Parent = ScreenGui
TextBox.Parent = Frame
CheckKey.Parent = Frame
CopyKey.Parent = Frame
Notification.Parent = ScreenGui

-- UI Properties
Frame.Size = UDim2.new(0, 350, 0, 150)
Frame.Position = UDim2.new(0.5, -175, 0.5, -75)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.BorderSizePixel = 2
Frame.BorderColor3 = Color3.fromRGB(0, 0, 0)

TextBox.Size = UDim2.new(0, 250, 0, 30)
TextBox.Position = UDim2.new(0.5, -125, 0.2, 0)
TextBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.PlaceholderText = "Enter Key To Access The Script"
TextBox.Text = ""

CheckKey.Size = UDim2.new(0, 120, 0, 35)
CheckKey.Position = UDim2.new(0.5, -130, 0.6, 0)
CheckKey.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
CheckKey.TextColor3 = Color3.fromRGB(255, 255, 255)
CheckKey.Text = "Check Key"

CopyKey.Size = UDim2.new(0, 120, 0, 35)
CopyKey.Position = UDim2.new(0.5, 10, 0.6, 0)
CopyKey.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
CopyKey.TextColor3 = Color3.fromRGB(255, 255, 255)
CopyKey.Text = "Copy Key Link"

-- Notification Label Properties
Notification.Size = UDim2.new(0, 200, 0, 40)
Notification.Position = UDim2.new(1, -210, 0.85, 0) -- Bottom right corner
Notification.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Notification.BackgroundTransparency = 0.4
Notification.TextColor3 = Color3.fromRGB(255, 255, 0) -- Vibrant yellow
Notification.TextScaled = true
Notification.Font = Enum.Font.SourceSansBold
Notification.Text = "Key copied to clipboard!"
Notification.Visible = false

-- Key validation function
local function validateKey(key)
    return key == "Rivals-DDAA-83QJ-DH83"
end

-- Key checking function
local function checkEnteredKey()
    local enteredKey = TextBox.Text
    if validateKey(enteredKey) then
        TextBox.TextColor3 = Color3.fromRGB(0, 255, 0) -- Green for correct key
        task.wait(0.5) -- Small delay for UI feedback
        ScreenGui:Destroy() -- Self-destruct the GUI
        loadstring(game:HttpGet("https://raw.githubusercontent.com/8bits4ya/rivals-v3/refs/heads/main/main.lua"))()
    else
        TextBox.TextColor3 = Color3.fromRGB(255, 0, 0) -- Red for incorrect key
    end
end

-- Key validation on button click
CheckKey.MouseButton1Click:Connect(checkEnteredKey)

-- Key validation when pressing Enter
TextBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        checkEnteredKey()
    end
end)

-- Copy key link to clipboard and show notification
CopyKey.MouseButton1Click:Connect(function()
    if setclipboard then
        setclipboard("https://link-center.net/1302195/rivals-key")
        
        -- Show notification
        Notification.Visible = true
        task.wait(2) -- Keep it visible for 2 seconds
        Notification.Visible = false
    end
end)

-- Dragging functionality
local dragging
local dragInput
local dragStart
local startPos

Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
